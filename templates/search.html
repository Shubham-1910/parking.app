{% extends "index.html" %} {% block title %}Search{% endblock %} {% block
content %}
<div class="container my-4">
  <form
    class="row g-2 align-items-center mb-4"
    method="get"
    action="{{ url_for('main.search') }}"
  >
    <div class="col-auto">
      <div class="input-group">
        <select class="form-select" name="search_by" style="max-width: 200px">
          <option value="user_id">User ID</option>
          <option value="username">Username</option>
          <option value="user_email">User Email</option>
          <!-- Collapsible options below -->

          <option value="user_address">User Address</option>
          <option value="user_city">User City</option>
          <option value="user_state">User State</option>
          <option value="lot_id">Parking Lot ID</option>
          <option value="prime_location_name">Prime Location Name</option>
          <option value="lot_address">Lot Address</option>
          <option value="pin_code">Pin Code</option>
          <option value="spot_id">Parking Spot ID</option>
          <option value="spot_status">Spot Status (O/A)</option>
          <option value="reservation_id">Reservation ID</option>
          <option value="reservation_user_id">Reservation User ID</option>
          <option value="reservation_spot_id">Reservation Spot ID</option>
        </select>
   
      </div>
    </div>
    <div class="col-auto">
      <input
        type="text"
        class="form-control"
        name="query"
        placeholder="Search..."
        value="{{ query }}"
      />
    </div>
    <div class="col-auto">
      <button class="btn btn-primary" type="submit">Search</button>
    </div>
  </form>

  {% if search_by == 'user_id' and results %}
  <h5>Users Found:</h5>
  <table class="table table-striped table-dark table-bordered align-middle">
    <thead>
      <tr>
        <th>ID</th>
        <th>Email</th>
        <th>Full Name</th>
        <th>Address</th>
        <th>Pin code</th>
      </tr>
    </thead>
    <tbody>
      {% for user in results %}
      <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.address }}</td>
        <td>{{ user.pin }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% elif search_by == 'location' and results %}
  <h5>Example search parking lots @{{ query }} location</h5>
  <div class="row">
    {% for lot in results %}
    <div class="col-md-4 mb-4">
      <div class="card shadow">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="card-title mb-0">Parking#{{ lot.lot_id }}</h5>
            <div>
              <a href="#" class="text-warning me-2">Edit</a>
              <a href="#" class="text-danger">Delete</a>
            </div>
          </div>
          <div class="mb-2 text-success">
            (Occupied : {{ lot.occupied }}/{{ lot.total }})
          </div>
          <div>
            {% for s in lot.spots %} {% if s == 'O' %}
            <button class="btn btn-sm btn-danger mb-1" disabled>O</button>
            {% else %}
            <button class="btn btn-sm btn-success mb-1" disabled>A</button>
            {% endif %} {% endfor %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% elif query %}
  <div class="alert alert-warning">No results found.</div>
  {% endif %}
</div>
{% endblock %}
